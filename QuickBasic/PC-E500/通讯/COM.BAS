10 *IN:CLS :CLOSE :OPEN "1200,N,8,1,A,L,&H1A":OPEN "E:COM.BAS"FOR INPUT AS &2:PRINT "OK"
20 A$=INPUT $(&1,&1):IF A$=CHR$ &81THEN PRINT #&1,"*";:END
30 IF A$<>CHR$ &82THEN 80
40 F$="E:"
50 A$=INPUT $(&1,&1):IF A$="*"THEN 70
60 F$=F$+A$:GOTO 50
70 CLOSE &2:PRINT "IN... ";F$:OPEN F$ FOR OUTPUT AS &2:PRINT #&1,"*";:GOTO 20
80 A$=INPUT $(ASC A$,&1):PRINT #&2,A$;:PRINT #&1,"*";:GOTO 20
90 *OUT:CLS :ERASE F$:DIM F$(&FF):FN=&
100 ON ERROR GOTO 150:RESTORE *FILE
110 READ A$:L=LEN A$:K=&:FN=FN+&1
120 FOR I=&1TO L:IF MID$ (A$,I,&1)="|"THEN K=I:I=L+&1
130 NEXT :IF K THEN F$(FN)=LEFT$ (A$,K-&1)+":"+RIGHT$ (A$,L-K) ELSE F$(FN)="E:"+A$
140 GOTO 110
150 IF FN=&THEN 240
160 CLOSE :OPEN "1200,N,8,1,A,L,&H1A"
170 FOR I=&1TO FN
180 PRINT "OUT... ";F$(I):OPEN F$(I)FOR INPUT AS &2:PRINT #&1,CHR$ &82;F$(I);CHR$ &D;
190 K=LOF &2:M=INT (K/&80):N=K-M*&80:IF M=&THEN 210
200 FOR J=&1TO M:PRINT #&1,CHR$ &80;:A$=INPUT $(&80,&2):PRINT #&1,A$;:NEXT
210 IF N=&THEN 230
220 PRINT #&1,CHR$ N;:A$=INPUT $(N,&2):PRINT #&1,A$;
230 CLOSE &2:NEXT :PRINT #1,CHR$ &81;
240 ERASE F$,P:END
250 *E:D$="E:":P=&80018:GOSUB 260:GOTO 150
260 Q=P:CLS :PRINT "Finding...":ERASE F$,P:DIM F$(&FF),P(&FF):FN=&
270 N=&8*(PEEK (P+&36)-PEEK (P+&3B))-&1:P=P+&100*PEEK (P+&3B)
280 FOR I=&TO N:IF PEEK (P+I*&20)=&THEN I=N+&1:GOTO 330
290 IF PEEK (P+I*&20)=&E5 THEN 330
300 F$=D$:FOR J=&TO &7:F$=F$+CHR$ PEEK (P+I*&20+J):NEXT
310 F$=F$+".":FOR J=&8TO &A:F$=F$+CHR$ PEEK (P+I*&20+J):NEXT
320 FN=FN+&1:F$(FN)=F$:P(FN)=P+I*&20
330 NEXT :P=Q:RETURN
1000 *FILE:DATA E|GL.BAS
