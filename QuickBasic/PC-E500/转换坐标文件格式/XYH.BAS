OPTION BASE 1
CLS
INPUT "×ª»»XYH.DAT(Y/N)"; A$
IF UCASE$(A$) <> "Y" THEN
 CLS
 SYSTEM
END IF
MAX = 500
DIM PT$(MAX)
DS = 0
OPEN "XYH.DAT" FOR INPUT AS 1
WHILE NOT EOF(1)
 LINE INPUT #1, D$
 K = INSTR(D$, ",")
 IF K <> 0 THEN
  DS = DS + 1
  D$ = LTRIM$(RTRIM$(D$))
  K = INSTR(D$, " DATA ")
  IF K <> 0 THEN
   PT$(DS) = MID$(D$, K + 6)
  ELSE
   PT$(DS) = D$
  END IF
 END IF
WEND
CLOSE
OPEN "XYH.DAT" FOR OUTPUT AS 2
PRINT #2, "1 DATA"; STR$(DS)
FOR I = 1 TO DS
 PRINT #2, LTRIM$(STR$(I * 10)); " DATA "; PT$(I)
NEXT
PRINT #2, LTRIM$(STR$(DS * 10 + 10)); " S=&1:MERGE " + CHR$(34) + "E:LOAD" + CHR$(34)
CLOSE
PRINT "OK"
SYSTEM

